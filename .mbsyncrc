# === Outlook School ===
IMAPAccount arizona
# Address to connect to
Host outlook.office365.com
User safwanelmadani@arizona.edu
# Use TLS
TLSType IMAPS
AuthMechs XOAUTH2
# PassCmd must print ONLY the access token to stdout
PassCmd "/usr/share/neomutt/oauth2/mutt_oauth2.py /home/safwan/.config/neomutt/safwanelmadani@arizona.edu-token"

IMAPStore arizona-remote
Account arizona

MaildirStore arizona-local
SubFolders Verbatim
# The trailing "/" is important
Path ~/Documents/mail/arizona/
Inbox ~/Documents/mail/arizona/Inbox

Channel arizona
Far :arizona-remote:
Near :arizona-local:
# Exclude everything under the internal [Gmail] folder, except the interesting folders
# Patterns * ![Gmail]* "[Gmail]/Sent Mail" "[Gmail]/Starred" "[Gmail]/All Mail"
# Or include everything
Patterns *
# Automatically create missing mailboxes, both locally and on the server
Create Both
# Sync the movement of messages between folders and deletions, add after making sure the sync works
Expunge Both
# Save the synchronization state files in the relevant directory
SyncState *

# === Outlook work ===
IMAPAccount work
# Address to connect to
Host 127.0.0.1
Port 1143
User safwanelmadani@ibm.com
PassCmd "pass work/email"
SSLType None
AuthMechs LOGIN
# Increase timeout to avoid o365 IMAP hiccups
Timeout 120
PipelineDepth 50

IMAPStore work-remote
Account work

MaildirStore work-local
# Copy folder hierarchy
Subfolders Verbatim
# The trailing "/" is important
Path ~/Documents/mail/work/
Inbox ~/Documents/mail/work/Inbox

Channel work
Far :work-remote:
Near :work-local:
# Include everything
Patterns *
# Automatically create missing mailboxes, both locally and on the server
Create Both
# Save the synchronization state files in the relevant directory
SyncState *
